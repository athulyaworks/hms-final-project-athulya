{% extends "base.html" %}
{% block content %}
<div class="container mt-4" style="max-width: 600px;">
    <h2>Register New Patient</h2>

    {% if messages %}
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }} mt-3">{{ message }}</div>
      {% endfor %}
    {% endif %}

    <form method="post" novalidate>
        {% csrf_token %}

        {# Non-field errors here #}
        {% if form.non_field_errors %}
          <div class="alert alert-danger">
            {% for error in form.non_field_errors %}
              <p>{{ error }}</p>
            {% endfor %}
          </div>
        {% endif %}

        <!-- User fields -->
        <div class="mb-3">
            <label for="id_username" class="form-label">Username</label>
            {{ form.username }}
            {{ form.username.errors }}
        </div>
        <div class="mb-3">
            <label for="id_email" class="form-label">Email</label>
            {{ form.email }}
            {{ form.email.errors }}
        </div>
        <div class="mb-3">
            <label for="id_first_name" class="form-label">First Name</label>
            {{ form.first_name }}
            {{ form.first_name.errors }}
        </div>
        <div class="mb-3">
            <label for="id_last_name" class="form-label">Last Name</label>
            {{ form.last_name }}
            {{ form.last_name.errors }}
        </div>

        <div class="mb-3">
            <label for="id_password" class="form-label">Password</label>
            {{ form.password }}
            {{ form.password.errors }}
        </div>

        <div class="mb-3">
            <label for="id_password2" class="form-label">Confirm Password</label>
            {{ form.password2 }}
            {{ form.password2.errors }}
        </div>

        <!-- Patient specific fields -->
        <div class="mb-3">
            <label for="id_age" class="form-label">Age</label>
            {{ form.age }}
            {{ form.age.errors }}
        </div>
        <div class="mb-3">
            <label for="id_gender" class="form-label">Gender</label>
            {{ form.gender }}
            {{ form.gender.errors }}
        </div>
        <div class="mb-3">
            <label for="id_contact_number" class="form-label">Contact Number</label>
            {{ form.contact_number }}
            {{ form.contact_number.errors }}
        </div>
        <div class="mb-3">
            <label for="id_address" class="form-label">Address</label>
            {{ form.address }}
            {{ form.address.errors }}
        </div>
        <div class="mb-3">
            <label for="id_medical_history" class="form-label">Medical History</label>
            {{ form.medical_history }}
            {{ form.medical_history.errors }}
        </div>
        <div class="mb-3 form-check">
            {{ form.is_inpatient }}
            <label class="form-check-label" for="{{ form.is_inpatient.id_for_label }}">Inpatient?</label>
        </div>

        <button type="submit" class="btn btn-primary">Register Patient</button>
        <!-- Correct namespaced URLs below -->
        <a href="{% url 'hospital:receptionist-dashboard' %}" class="btn btn-secondary ms-2">Cancel</a>
        <a href="{% url 'hospital:receptionist-dashboard' %}" class="btn btn-outline-secondary ms-2">Back to Dashboard</a>
    </form>
</div>
{% endblock %}
